
# 🧱 Sokoban Game Server - IOCP 기반 비동기 네트워크 게임 서버

> Windows IOCP(입출력 완료 포트) 기반의 고성능 비동기 서버에서 동작하는 콘솔 기반 소코반 게임입니다.  
> 최대 100명의 클라이언트가 동시에 접속하여 각자 독립적으로 게임을 진행할 수 있습니다.

---

## 📌 프로젝트 개요

- **게임명**: 소코반 (Sokoban)
- **형태**: 콘솔 기반 퍼즐 게임 (서버-클라이언트 모델)
- **목표**: IOCP 기반 네트워크 프로그래밍 학습 및 고성능 서버 구조 설계 실습

---

## ⚙️ 개발 환경 및 기술 스택

| 항목          | 내용                                               |
|---------------|----------------------------------------------------|
| 언어          | C++                                                |
| 네트워크      | WinSock 2, TCP 소켓, IOCP (I/O Completion Port)    |
| 운영체제      | Windows 10                                        |
| 개발 환경     | Visual Studio 2019                                 |
| 멀티스레드    | CreateThread, CriticalSection, Worker Thread       |
| 입력 처리     | `_getch()`를 통한 실시간 키보드 입력               |
| 동기화        | Critical Section을 통한 스레드 간 자원 보호        |

---

## 🕹 주요 기능

- IOCP 기반 비동기 서버 구조
- 최대 **100명 동시 접속 처리**
- 각 유저별로 **맵 상태 독립 관리**
- 게임 내 주요 기능:
  - 맵 이동 (W, A, S, D)
  - 맵 초기화 (R)
  - 게임 종료 (P)
  - 스테이지 클리어 및 진행
- 클라이언트와 서버 간 **패킷 기반 프로토콜 통신**
- 에러 및 연결 종료에 대한 **안정적인 예외 처리**

---

## 🏗 구조 설명

### 📁 주요 구성 파일

| 파일명           | 설명                                          |
|------------------|-----------------------------------------------|
| `main.cpp`       | 서버 초기화 및 IOCP 스레드 풀 구성             |
| `WorkerThread.cpp`| IOCP 큐에서 이벤트 처리 (RECV, SEND 등)       |
| `Packet.cpp`     | Pack/Unpack 함수로 프로토콜 직렬화 처리        |
| `Global.h`       | 전역 설정, 구조체, enum, 맵 데이터 정의        |
| `SokobanMap`     | 고정된 스테이지 맵 3개 내장                    |
| `generalfunc.cpp`| 클라이언트 등록/삭제, 상태 분기, 게임 처리 로직 |

### 🧠 핵심 설계 요소

- **IOCP 이벤트 큐 기반 스레드 처리**
- **ClientInfo 구조체**로 클라이언트별 상태 및 버퍼 관리
- **WSAOVERLAPPED_EX**: 사용자 정의 Overlapped 구조
- **PackPacket / UnPackPacket**: 커스텀 프로토콜 직렬화 구현
- **STATE / IO_TYPE 기반 상태 머신 설계**

---

## 🚀 실행 방법

### ✅ 1. Visual Studio에서 실행

1. 프로젝트 열기
2. `main.cpp` 파일의 `#define MAIN`이 정의되어 있는지 확인
3. `x86` 또는 `x64` Debug/Release 모드로 빌드
4. 서버 실행 (`Ctrl + F5`)
5. 클라이언트는 동일한 IP/포트(`127.0.0.1:9000`)로 연결

### ✅ 2. 실행 전 요구사항

- Windows 플랫폼 (IOCP는 Windows 전용)
- 관리자 권한으로 실행 (소켓 API 사용 시 권한 문제 방지)

---

## 🌱 향후 확장 가능성

- 멀티 유저 협동 모드 (동일 맵 동기화)
- 채팅 기능 추가
- 유저 랭킹 저장 (파일 또는 DB)
- 맵 로딩 기능 (텍스트 파일 기반 사용자 맵)
- GUI 클라이언트 연동 (예: MFC, Qt 등)

---

## 🙌 기여 및 문의

이 프로젝트는 개인 학습 및 포트폴리오 목적입니다.  
기술적인 피드백이나 확장 기여는 언제든 환영합니다!

📫 문의: [GPTOnline.ai](https://gptonline.ai/ko/)

---

## 🧠 학습 포인트 정리

- 고성능 서버 설계 (IOCP)
- 프로토콜 설계 및 버퍼 직렬화
- 스레드 동기화 및 자원 관리
- 구조화된 코드 설계 및 확장성 고려

---

